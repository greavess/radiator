<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>MAC filter — filter_mac • radiator</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="MAC filter — filter_mac"><meta property="og:description" content="The Minor Allele Count function
remove/blacklist markers based on Minor/Alternate Allele Count (MAC). Use it
to remove noise, sequencing errors or low polymorphism markers. Some
analysis performs better with the full spectrum of allele frequency, so careful
with high threshold that inevitably results in biaises.
Filter targets: Marker's alternate allele(s)
Statistics: count of the allele per markers. This filter as NO concept
of strata/populations. It is computed globally."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">radiator</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">Installation</a>
</li>
<li>
  <a href="../articles/get_started.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/rad_genomics_computer_setup.html">Computer setup - Installation - Troubleshooting</a>
    </li>
    <li>
      <a href="../articles/life_cycle.html">Life cycle</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/thierrygosselin/radiator" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>MAC filter</h1>
    <small class="dont-index">Source: <a href="https://github.com/thierrygosselin/radiator/blob/HEAD/R/filter_mac.R" class="external-link"><code>R/filter_mac.R</code></a></small>
    <div class="hidden name"><code>filter_mac.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The Minor Allele Count function
remove/blacklist markers based on Minor/Alternate Allele Count (MAC). Use it
to remove noise, sequencing errors or low polymorphism markers. Some
analysis performs better with the full spectrum of allele frequency, so careful
with high threshold that inevitably results in biaises.</p>
<p><strong>Filter targets</strong>: Marker's alternate allele(s)</p>
<p><strong>Statistics</strong>: count of the allele per markers. This filter as NO concept
of strata/populations. It is computed globally.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">filter_mac</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  interactive.filter <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  filter.mac <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  filename <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parallel.core <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>(4 options) A file or object generated by radiator:</p><ul><li><p>tidy data</p></li>
<li><p>Genomic Data Structure (GDS)</p></li>
</ul><p><em>How to get GDS and tidy data ?</em>
Look into <code><a href="tidy_genomic_data.html">tidy_genomic_data</a></code>,
<code><a href="read_vcf.html">read_vcf</a></code> or
<code><a href="tidy_vcf.html">tidy_vcf</a></code>.</p></dd>


<dt>interactive.filter</dt>
<dd><p>(optional, logical) Do you want the filtering session to
be interactive. Figures of distribution are shown before asking for filtering
thresholds.
Default: <code>interactive.filter = TRUE</code>.</p></dd>


<dt>filter.mac</dt>
<dd><p>(optional, integer) The number of alternate (minor) allele
to keep a SNP (see details). e.g. <code>filter.mac = 3</code>. This argument as no
concept of locus, local or strata or pop. It's applied globally, by SNPs.
Default: <code>filter.mac = NULL</code>.</p></dd>


<dt>filename</dt>
<dd><p>(optional, character) Write to folder the MAF filtered
tidy dataset. The name will be appended <code>.rad</code>. With default, the filtered
data is only in the global environment.
Default: <code>filename = NULL</code>.</p></dd>


<dt>parallel.core</dt>
<dd><p>(optional) The number of core used for parallel
execution during import.
Default: <code>parallel.core = parallel::detectCores() - 1</code>.</p></dd>


<dt>verbose</dt>
<dd><p>(optional, logical) When <code>verbose = TRUE</code>
the function is a little more chatty during execution.
Default: <code>verbose = TRUE</code>.</p></dd>


<dt>...</dt>
<dd><p>(optional) Advance mode that allows to pass further arguments
for fine-tuning the function. Also used for legacy arguments (see details or
special section)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>With <code>interactive.filter = FALSE</code>, a list in the global environment,
with 7 objects:</p><ol><li><p>$tidy.filtered.mac</p></li>
<li><p>$whitelist.markers</p></li>
<li><p>$blacklist.markers</p></li>
<li><p>$mac.data</p></li>
<li><p>$filters.parameters</p></li>
</ol><p>With <code>interactive.filter = TRUE</code>, a list with 4 additionnal objects are generated.</p><ol><li><p>$distribution.mac.global</p></li>
<li><p>$distribution.mac.local</p></li>
<li><p>$mac.global.summary</p></li>
<li><p>$mac.helper.table</p></li>
</ol><p><strong>mac.helper.table:</strong></p>



<p>First and second variables (in columns) represents POP_ID and sample size (n).</p>


<p>The last 2 rows are the local MAF (suggested based on the lowest pop value)
and the TOTAL/GLOBAL observations.</p>


<p>Columns starting with ALT are the variable corresponding
to the number of alternative (ALT) allele (ranging from 1 to 20).
The observations in the ALT allele variable columns are the local (for the pop)
and global (last row) MAF of your dataset.
e.g. ALT_3 can potentially represent 3 heterozygote individuals with
the ALT allele or 1 homozygote individuals for the ALT allele and
1 heterozygote individual. And so on...</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>Thanks to Charles Perrier and Jeremy Gaudin for very useful comments
on previous version of this function.</p>
    </div>
    <div id="mac-or-maf-">
    <h2>MAC or MAF ?</h2>
    

<p>Using count or frequency to remove a SNPs ? The preferred choice in radiator
as changed from frequency to count, because we think the filtering should not
alter the spectrum and this is only achieved if the same criteria is applied
for each SNP.</p>

<p>Even small differences in missing data between RADseq markers
generates differences in MAF frequency thresholds applied.</p>
<p>Example with a datset consisting of N = 36 individuals and 3 SNPs
with varying level of missing genotypes:</p>
<ul><li><p><code>SNP number : number samples genotypes : REF/ALT counts</code></p></li>
<li><p>SNP1 : 36 : 69/3</p></li>
<li><p>SNP2 : 30 : 65/3</p></li>
<li><p>SNP3 : 24 : 45/3</p></li>
</ul><p>Each SNPs have the same alternate allele count, corresponding to
2 individuals with the polymorphism: 1 homozygote + 1 heterozygote.
Applying a MAF threshold of
0.05 would mean that SNP3 would be blacklisted
(<code>24 * 2 * 0.05 = 2.4 alt alleles required to pass</code>).</p>

<p><strong>Using count instead of frequency allows each RADseq markers,
with varying missing data, to be treated equally.</strong></p>
    </div>
    <div id="advance-mode">
    <h2>Advance mode</h2>
    


<p><em>dots-dots-dots ...</em> allows to pass several arguments for fine-tuning the function:</p><ol><li><p><code>filter.common.markers</code> (optional, logical).
Default: <code>filter.common.markers = FALSE</code>,
Documented in <code><a href="filter_common_markers.html">filter_common_markers</a></code>.</p></li>
<li><p><code>filter.monomorphic</code> (logical, optional) Should the monomorphic
markers present in the dataset be filtered out ?
Default: <code>filter.monomorphic = TRUE</code>.
Documented in <code><a href="filter_monomorphic.html">filter_monomorphic</a></code>.</p></li>
<li><p><code>path.folder</code>: to write ouput in a specific path
(used internally in radiator).
Default: <code>path.folder = getwd()</code>.
If the supplied directory doesn't exist, it's created.</p></li>
</ol></div>
    <div id="interactive-version">
    <h2>Interactive version</h2>
    


<p>To help choose a threshold for the local and global MAF
use the interactive version.</p>
<p>2 steps in the interactive version:</p>
<p>Step 1. Visualization and helper table.</p>
<p>Step 2. Filtering markers based on MAC</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Linck, E., Battey, C. (2019).
Minor allele frequency thresholds strongly affect population structure
inference with genomic data sets.
Molecular Ecology Resources 19(3), 639-647.
https://dx.doi.org/10.1111/1755-0998.12995</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Thierry Gosselin <a href="mailto:thierrygosselin@icloud.com">thierrygosselin@icloud.com</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># The minumum</span></span></span>
<span class="r-in"><span><span class="va">mac</span> <span class="op">&lt;-</span> <span class="fu">radiator</span><span class="fu">::</span><span class="fu">filter_mac</span><span class="op">(</span>data <span class="op">=</span> <span class="va">turtle.tidy.data</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># This will use the default: interactive version,</span></span></span>
<span class="r-in"><span><span class="co"># a list is created and to view the filtered tidy data:</span></span></span>
<span class="r-in"><span><span class="va">mac.tidy.data</span> <span class="op">&lt;-</span> <span class="va">mac</span><span class="op">$</span><span class="va">tidy.filtered.mac</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># No user interaction</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Using filter.mac = 4, is a good practice to remove mostly sequencing errors</span></span></span>
<span class="r-in"><span><span class="co"># and assembly artifacts, because it requires the markers to be genotyped in</span></span></span>
<span class="r-in"><span><span class="co"># 4 heterozygote individuals or 2 homozygote individuals for the alternate</span></span></span>
<span class="r-in"><span><span class="co"># allele or 2 heterozygote individuals and 1 homozygote individual for the</span></span></span>
<span class="r-in"><span><span class="co"># alternate allele. Overall, never less than 2 indiduals are required.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mac</span> <span class="op">&lt;-</span> <span class="fu">radiator</span><span class="fu">::</span><span class="fu">filter_mac</span><span class="op">(</span></span></span>
<span class="r-in"><span>        data <span class="op">=</span> <span class="va">turtle.gds</span>, <span class="co"># using gds object</span></span></span>
<span class="r-in"><span>        filter.mac <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>        filename <span class="op">=</span> <span class="st">"turtle.mac"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># This will remove monomorphic markers (by default filter.monomorphic = TRUE)</span></span></span>
<span class="r-in"><span><span class="co"># The filtered data will be written in the directory under the name:</span></span></span>
<span class="r-in"><span><span class="co"># turtle.maf.rad</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Thierry Gosselin.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

